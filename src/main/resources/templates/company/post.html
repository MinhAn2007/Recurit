<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Post Job</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
</head>
<body>
<div class="container mt-5">
    <h1 class="text-center">Post Job</h1>
    <form th:action="@{'/company/' + ${companyId} + '/jobs'}" th:object="${job}" method="post">
        <input type="hidden" th:field="*{company.id}">
        <div class="mb-3">
            <label for="name" class="form-label">Job Name</label>
            <input type="text" class="form-control" id="name" th:field="*{name}" required>
        </div>
        <div class="mb-3">
            <label for="description" class="form-label">Job Description</label>
            <textarea class="form-control" id="description" th:field="*{description}" required></textarea>
        </div>
        <span th:text="${company.name}"></span>

        <div id="skillsSection">
            <div class="mb-3" th:each="skill, status : ${job.jobSkills}">
                <label for="skillName" class="form-label">Skill Name</label>
                <input type="text" id="skillName" class="form-control" th:field="*{jobSkills[__${status.index}__].skillName}" required>

                <label for="skillDes" class="form-label">Skill Description</label>
                <input type="text" id="skillDes" class="form-control" th:field="*{jobSkills[__${status.index}__].skillDescription}" required>

                <label for="skillType" class="form-label">Skill Type</label>
                <select class="form-select" id="skillType" th:field="*{jobSkills[__${status.index}__].skillType}">
                    <option th:each="type : ${T(vn.edu.iuh.fit.www_lab05.backend.enums.SkillType).values()}"
                            th:value="${type}" th:text="${type}">
                    </option>
                </select>
            </div>
        </div>

        <button type="button" onclick="addSkillRow()" class="btn btn-secondary">Add More Skill</button>

        <button type="submit" class="btn btn-primary">Submit</button>
    </form>
</div>

<script th:inline="javascript">
    var currentIndex =[] /* set the initial index value, e.g., ${job.jobSkills.size()} */;

    function addSkillRow() {
        var skillsSection = document.getElementById("skillsSection");
        var newRow = document.createElement("div");
        newRow.className = "mb-3";

        // Skill Name Input
        var skillNameInput = document.createElement("input");
        skillNameInput.type = "text";
        skillNameInput.className = "form-control";
        skillNameInput.name = "jobSkills[" + currentIndex + "].skillName";
        skillNameInput.required = true;

        // Skill Description Input
        var skillDesInput = document.createElement("input");
        skillDesInput.type = "text";
        skillDesInput.className = "form-control";
        skillDesInput.name = "jobSkills[" + currentIndex + "].skillDescription";
        skillDesInput.required = true;

        // Skill Type Select
        var skillTypeSelect = document.createElement("select");
        skillTypeSelect.className = "form-select";
        skillTypeSelect.name = "jobSkills[" + currentIndex + "].skillType";

        // Populate options for Skill Type Select
        /* You can dynamically populate the options based on your SkillType enum */

        // Increment the current index for the next row
        currentIndex++;

        // Append inputs to the new row
        newRow.appendChild(skillNameInput);
        newRow.appendChild(skillDesInput);
        newRow.appendChild(skillTypeSelect);

        // Append the new row to the skillsSection
        skillsSection.appendChild(newRow);
    }
</script>

</body>
</html>
